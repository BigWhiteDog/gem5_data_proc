#!/usr/bin/env python3.6

import os
from os.path import join as pjoin
import time
import re
import argparse
import pandas as pd
import numpy as np

from paths import *
import common as c
from target_stats import *
from st_stat import make_st_stat_cache



parser = argparse.ArgumentParser(description='check sum of slots',
                                prefix_chars='-')
parser.add_argument('-s', '--stats',
                    default='./stats.txt',
                    help='stats.txt to be converted')
parser.add_argument('-n', '--num-insts',
                    default=0,
                    help='inst number to be searched')


opt = parser.parse_args()
curdir = os.getcwd()
make_st_stat_cache()

max_insts = 200*10**6

if opt.num_insts:
    num_insts = opt.num_insts
else:
    num_insts = max_insts

hpt = re.search('(\w+)_\w+$', curdir).group(1)

d = c.get_stats(opt.stats, standard_targets, num_insts, re_targets=True)
c.add_st_ipc(hpt, d)
c.add_ipc_pred(d)
c.add_slot_sanity(d)
c.print_dict(d)

